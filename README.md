# Библиотека для запуска кода Перфоленты из скриптов OneScript.

Библиотека позволяет компилировать на лету и тут же запускать без сохранения на диск, код написанный на языке программирования Перфолента.Net.
Возможно так же подключение откомпилированого кода в качестве внешней компоненты для работы с классами.

## Одновременная компиляция и запуск.
Методы КомпилироватьИВыполнить и КомпилироватьИВыполнитьИзФайла подходят для однократного или редкого выполнения кода Перфоленты, 
т.к. компиляция происходит при каждом вызове метода, что занимает некоторое время.
```bsl
Скрипт = "
|Программа ЗапускКода
|    Функция Старт(Чис тип Объект) тип Строка
|       ВыводСтроки Чис
|       Возврат ""ОК! Выполнено!!!""
|    КонецФункции
|КонецПрограммы 
|";
П = Новый Перфолента;
Результат = П.КомпилироватьИВыполнить(Скрипт,555));
//то же самое, но скрипт должен находиться в файле
Результат = П.КомпилироватьИВыполнитьИзФайла("C:\МойСкрипт.пфлс",555));
```

## Компиляция и многократный запуск.
Подходит для многократного выполнения кода Перфоленты, т.к. компиляется выполняется один раз перед выполнением.

```bsl
П = Новый Перфолента;
П.Текст = "
|Программа ЗапускКода
|    Функция Старт(Чис тип Объект) тип Строка
|       ВыводСтроки Чис
|       Возврат ""ОК! Выполнено!!!""
|    КонецФункции
|КонецПрограммы 
|";
//указываем имя модуля Программа, если оно задано в скрипте...
П.Компилировать("ЗапускКода"); 
//команду Выполнить можно запускать многократно с разными параметрами
Результат = П.Выполнить(333);
Результат = П.Выполнить(555);
Результат = П.Выполнить(777);
```

## Подключаем как внешнюю компоненту.
Подходит для использования классов определенных в программе написанной на языке Перфолента.

```bsl
П = Новый Перфолента;
П.Текст = "
|&ВидноВсем Класс Котик    
|    &ВидноВсем Свойство Имя тип Строка = ""Безымянный""
|    &ВидноВсем Функция Мяу() тип Строка
|       Возврат ""МЯУ!!!""
|    КонецФункции
|КонецКласса    
|";
П.Компилировать(); 
П.ПодключитьКакВнешнююКомпоненту();
Котик = Новый COMОбъект("Котик");
Сообщить("Было имя: "+Котик.Имя);
Котик.Имя="Васька";
Сообщить("Стало имя: "+Котик.Имя);
Сообщить(Котик.Мяу());
```
  
 
 
